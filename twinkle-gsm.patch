--- twinkle-0.8.1/configure.in.orig	2006-07-09 16:09:11.000000000 +0200
+++ twinkle-0.8.1/configure.in	2006-07-10 17:24:58.371947250 +0200
@@ -160,6 +160,12 @@
 	have_speex="no"
 fi
 
+# Check if libgsm is available
+AC_CHECK_LIB(gsm, sf_open, [],
+	[AC_MSG_ERROR([libgsm library is missing.])])
+AC_CHECK_HEADER(gsm.h, [],
+	[AC_MSG_ERROR([gsm header files missing (gsm.h)])])
+
 # iLBC
 if test "x$ac_cv_ilbc" = "xyes"
 then
@@ -196,7 +202,7 @@
 PARSER_CXXFLAGS=`echo $CXXFLAGS | sed -e "s/\-O2//;s/\-Os//"`
 AC_SUBST(PARSER_CXXFLAGS)
 
-AC_OUTPUT(Makefile src/Makefile src/audio/Makefile src/audio/gsm/Makefile \
+AC_OUTPUT(Makefile src/Makefile src/audio/Makefile \
 	src/audits/Makefile src/sdp/Makefile src/parser/Makefile \
 	src/sockets/Makefile src/stun/Makefile src/threads/Makefile \
 	twinkle.spec)
--- twinkle-0.8/src/audio/audio_decoder.h.orig	2006-05-13 10:24:32.000000000 +0200
+++ twinkle-0.8/src/audio/audio_decoder.h	2006-07-02 08:20:45.948399750 +0200
@@ -25,7 +25,7 @@
 #include "twinkle_config.h"
 #include "audio_codecs.h"
 #include "user.h"
-#include "gsm/inc/gsm.h"
+#include <gsm.h>
 
 #ifdef HAVE_SPEEX
 #include <speex/speex.h>
--- twinkle-0.7/src/audio/audio_encoder.h.orig	2006-04-16 20:51:14.000000000 +0200
+++ twinkle-0.7/src/audio/audio_encoder.h	2006-04-30 15:40:37.000000000 +0200
@@ -25,7 +25,7 @@
 #include "twinkle_config.h"
 #include "audio_codecs.h"
 #include "user.h"
-#include "gsm/inc/gsm.h"
+#include <gsm.h>
 
 #ifdef HAVE_SPEEX
 #include <speex/speex.h>
--- twinkle-0.8/src/audio/audio_tx.h.orig	2006-05-13 09:50:14.000000000 +0200
+++ twinkle-0.8/src/audio/audio_tx.h	2006-07-02 08:22:38.423429000 +0200
@@ -30,7 +30,7 @@
 #include "rtp_telephone_event.h"
 #include "user.h"
 #include "threads/mutex.h"
-#include "gsm/inc/gsm.h"
+#include <gsm.h>
 #include "audio_device.h"
 #include "twinkle_rtp_session.h"
 #include "twinkle_config.h"
--- twinkle-0.8.1/src/audio/Makefile.am.orig	2006-07-07 20:39:35.000000000 +0200
+++ twinkle-0.8.1/src/audio/Makefile.am	2006-07-10 17:28:47.042238250 +0200
@@ -37,6 +37,6 @@
         tone_gen.h\
         twinkle_rtp_session.h
 
-SUBDIRS = gsm
+SUBDIRS =
 
 EXTRA_DIST = README_G711

--- twinkle/src/gui/twinkle.pro.org	2007-02-28 01:27:31.194623000 +0100
+++ twinkle/src/gui/twinkle.pro	2007-02-28 01:28:02.870623000 +0100
@@ -3,7 +3,7 @@
 
 CONFIG	+= qt warn_off release thread
 
-LIBS	+= ../libtwinkle.a ../parser/libsipparser.a ../sdp/libsdpparser.a ../sockets/libsocket.a ../threads/libthread.a ../audio/libaudio.a ../audio/gsm/libgsm.a ../audits/libaudits.a ../stun/libstun.a ../mwi/libmwi.a -lsndfile
+LIBS	+= ../libtwinkle.a ../parser/libsipparser.a ../sdp/libsdpparser.a ../sockets/libsocket.a ../threads/libthread.a ../audio/libaudio.a ../audits/libaudits.a ../stun/libstun.a ../mwi/libmwi.a -lsndfile -lgsm
 
 DEFINES	+= QT_NO_STL
 
--- twinkle/src/Makefile.am.org	2007-02-28 01:28:25.106623000 +0100
+++ twinkle/src/Makefile.am	2007-02-28 01:28:41.186623000 +0100
@@ -16,12 +16,12 @@
         $(top_builddir)/src/sockets/libsocket.a\
         $(top_builddir)/src/threads/libthread.a\
         $(top_builddir)/src/audio/libaudio.a\
-        $(top_builddir)/src/audio/gsm/libgsm.a\
         $(top_builddir)/src/audits/libaudits.a\
         $(top_builddir)/src/stun/libstun.a\
         $(top_builddir)/src/mwi/libmwi.a\
 	$(CCRTP_LIBS)\
-	-lsndfile
+	-lsndfile \
+	-lgsm
 
 libtwinkle_a_SOURCES =\
 	abstract_dialog.cpp\
